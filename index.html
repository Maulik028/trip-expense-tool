<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Trip Expense Sharing Tool</title>
<style>
   body { font-family: Arial; margin: 20px; }
   h2 { margin-top: 40px; }
   input, button, select { padding: 6px; margin: 6px 0; }
   table { border-collapse: collapse; width: 100%; margin-top: 20px; }
   table, th, td { border: 1px solid #888; padding: 8px; }
   .person-box, .expense-box { border: 1px solid #ccc; padding: 15px; margin: 10px 0; }
</style>
</head>
<body>
<h1>Trip Expense Sharing Tool</h1>
<!-- ADD PERSON -->
<div class="person-box">
<h2>Add Person</h2>
<input id="personName" placeholder="Enter name">
<button onclick="addPerson()">Add</button>
<h3>People List</h3>
<ul id="peopleList"></ul>
</div>
<!-- ADD EXPENSE -->
<div class="expense-box">
<h2>Add Expense</h2>
<input id="expenseTitle" placeholder="Expense Title (Food, Travel)">
<input id="expenseAmount" type="number" placeholder="Amount">
<select id="expensePaidBy"></select>
<button onclick="addExpense()">Add Expense</button>
<h3>Expenses List</h3>
<table>
<thead>
<tr><th>Title</th><th>Amount</th><th>Paid By</th><th>Delete</th></tr>
</thead>
<tbody id="expenseTable"></tbody>
</table>
</div>
<!-- SUMMARY -->
<h2>Summary</h2>
<p><strong>Total Expense:</strong> ₹<span id="totalExpense">0</span></p>
<p><strong>Average Per Person Cost:</strong> ₹<span id="avgCost">0</span></p>
<button onclick="calculateSettlement()">Calculate Settlement</button>
<h2>Settlement Result</h2>
<ul id="settlementList"></ul>
<script>
let persons = [];
let expenses = [];
// Add person
function addPerson() {
   const name = document.getElementById('personName').value.trim();
   if (name === "") return alert("Enter a valid name.");
   persons.push(name);
   document.getElementById('personName').value = "";
   updatePeople();
   updatePersonDropdown();
}
// Delete person
function deletePerson(index) {
   persons.splice(index, 1);
   updatePeople();
   updatePersonDropdown();
}
// Update people list UI
function updatePeople() {
   const list = document.getElementById('peopleList');
   list.innerHTML = "";
   persons.forEach((p, i) => {
       list.innerHTML += `<li>${p} <button onclick="deletePerson(${i})">Delete</button></li>`;
   });
}
// Update dropdown for "Paid By"
function updatePersonDropdown() {
   const dropdown = document.getElementById('expensePaidBy');
   dropdown.innerHTML = "";
   persons.forEach(p => {
       dropdown.innerHTML += `<option>${p}</option>`;
   });
}
// Add expense
function addExpense() {
   const title = document.getElementById('expenseTitle').value.trim();
   const amount = parseFloat(document.getElementById('expenseAmount').value);
   const paidBy = document.getElementById('expensePaidBy').value;
   if (!title || isNaN(amount) || amount <= 0) return alert("Enter valid expense details.");
   expenses.push({ title, amount, paidBy });
   document.getElementById('expenseTitle').value = "";
   document.getElementById('expenseAmount').value = "";
   updateExpenseTable();
}
// Delete expense
function deleteExpense(index) {
   expenses.splice(index, 1);
   updateExpenseTable();
}
// Update expense table UI
function updateExpenseTable() {
   const tbody = document.getElementById('expenseTable');
   tbody.innerHTML = "";
   expenses.forEach((ex, i) => {
       tbody.innerHTML += `
<tr>
<td>${ex.title}</td>
<td>₹${ex.amount}</td>
<td>${ex.paidBy}</td>
<td><button onclick="deleteExpense(${i})">Delete</button></td>
</tr>
       `;
   });
   updateSummary();
}
// Summary calculations
function updateSummary() {
   const total = expenses.reduce((sum, ex) => sum + ex.amount, 0);
   document.getElementById('totalExpense').innerText = total;
   const avg = persons.length ? (total / persons.length).toFixed(2) : 0;
   document.getElementById('avgCost').innerText = avg;
}
// Settlement calculation
function calculateSettlement() {
   if (persons.length === 0 || expenses.length === 0) {
       return alert("Add persons and expenses first!");
   }
   const total = expenses.reduce((sum, ex) => sum + ex.amount, 0);
   const avg = total / persons.length;
   let balance = {};
   persons.forEach(p => balance[p] = 0);
   expenses.forEach(ex => balance[ex.paidBy] += ex.amount);
   persons.forEach(p => balance[p] -= avg);
   let debtors = [];
   let creditors = [];
   for (let p in balance) {
       if (balance[p] < 0) debtors.push({ name: p, amount: -balance[p] });
       else if (balance[p] > 0) creditors.push({ name: p, amount: balance[p] });
   }
   let result = [];
   let i = 0, j = 0;
   while (i < debtors.length && j < creditors.length) {
       let pay = Math.min(debtors[i].amount, creditors[j].amount);
       result.push(`${debtors[i].name} → ₹${pay.toFixed(2)} → ${creditors[j].name}`);
       debtors[i].amount -= pay;
       creditors[j].amount -= pay;
       if (debtors[i].amount === 0) i++;
       if (creditors[j].amount === 0) j++;
   }
   const ul = document.getElementById('settlementList');
   ul.innerHTML = "";
   result.forEach(r => ul.innerHTML += `<li>${r}</li>`);
}
</script>
</body>
</html>